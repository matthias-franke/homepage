<!DOCTYPE html>
<html>
<head>
	<meta content="IE=edge" http-equiv="X-UA-Compatible" />
	<meta charset="utf-8" content="text/html;" http-equiv="Content-Type" />
	<meta content="INDEX,FOLLOW" name="robots" />
	<meta content=" homepage" name="page-type" />
	<meta content="width=device-width, initial-scale=1" name="viewport" />
	<meta content="Matthias Franke" name="keywords" />
	<meta content="homepage, dokument, webpage, page, web, netz" name="description" />
	<link href="style.css" rel="stylesheet" type="text/css" />
</head>


<body>
	
	<a class="menu" id="menu" href="javascript:void(0);" onclick="toggleDisplay('nav');">&equiv;</a>

	
	<nav id="nav">
	<ul>
		
	<li><a href="index.html">&#8743;<span class="sub"> </span></a></li>

	<li><a href="toc.html#code">Code<span class="sub"> </span></a><ul>
		<li><a href="justus.html">Projekt Justus<span class="sub">  smart contracts</span></a></li>
		<li><a href="codePytemp.html">pytemp<span class="sub"> </span></a></li>
		<li><a href="codeCssMenu.html">CSS Webpage Menu<span class="sub"> </span></a></li>
	</ul></li>

	<li><a href="toc.html#text">Text<span class="sub"> </span></a><ul>
		<li><a href="toc.html#textFiktion">Fiktionales<span class="sub"> </span></a><ul>
			<li><a href="textFiktionVerlierer.html">Der Verlierer <span class="sub"> - Krimi - Fliesstext</span></a></li>
			<li><a href="textFiktionVerlierer/index.html">Der Verlierer <span class="sub"> - Krimi - interaktiv</span></a></li>
			<li><a href="textFiktionBrueller.html">Der Br&#252;ller <span class="sub"> - Ein Bericht</span></a></li>
		</ul></li>
		<li><a href="toc.html#textAcademic">Akademisches<span class="sub"> </span></a><ul>
			
			<li><a href="textAcademicInetLiteraturN.html">Literatur im Internet<span class="sub"> </span></a></li>
			<li><a href="wiah.html">Ein Versuch &#252;ber die Tendenz eines Witzes<span class="sub"> </span></a></li>
		</ul></li>		
		<li><a href="toc.html#textJournal">Journalistisches<span class="sub"> </span></a><ul>
			<li><a href="toc.html#textJournalBericht">Bericht<span class="sub"> </span></a><ul>
				<li><a href="toc.html#textJournalBerichtComputer">Computer<span class="sub"> </span></a><ul>
					<li><a href="jbahschachtner.html">Das virtuelle Geschlecht<span class="sub"> Interview mit Christina Schachtner</span></a></li>
					<li><a href="jbbhcomp.html">Unbekannte Wesen<span class="sub"> &#252;ber menschlichen Umgang mit Computern</span></a></li>
					<li><a href="jbchAlpar.html">WWW Wohin?<span class="sub"> Wie begr&#252;ndet ist das Internet-Fieber der Wirtschaftsstrategen?</span></a></li>
				</ul></li>
				<li><a href="toc.html#textJournalBerichtTechnik">Technik<span class="sub"> </span></a><ul>
					<li><a href="jbdhschalt.html">Die lineare Innovation<span class="sub"> Einige Entwicklungen bei Schaltwerken vor allem im MTB-Bereich</span></a></li>
					<li><a href="jbehhelm.html">Helm auf!<span class="sub"> Gesetzliche Helmpflicht f&#252;r Radfahrer</span></a></li>
					<li><a href="jbghdaemm.html">Die regenerativen Alternativen<span class="sub"> Wie nat&#252;rlich sind die Naturd&#228;mmstoffe?</span></a></li>
				</ul></li>				
				<li><a href="toc.html#textJournalBerichtGesundheit">Gesundheit<span class="sub"> </span></a><ul>
					<li><a href="jbhhfuss.html">Von Kindesbeinen an getreten: Die F&#252;&#223;e<span class="sub"> </span></a></li>
					<li><a href="jbihvitamin.html">Sch&#228;den durch Vitamin A?<span class="sub"> </span></a></li>
				</ul></li>				
				<li><a href="toc.html#textJournalBerichtWirtschaft">Wirtschaft<span class="sub"> </span></a><ul>
					<li><a href="jbjhecom.html">Gesch&#228;fte gehen ins Netz<span class="sub"> Die neue Studie zu den Schwierigkeiten der Unternehmer mit Electronic Commerce</span></a></li>
					<li><a href="jbkhboerse.html">B&#246;rse zweiter Klasse<span class="sub"> Bauaktien leiden an der Wiener B&#246;rse</span></a></li>
					<li><a href="jbrhimmobil.html">Immobilien<span class="sub"> </span></a></li>
					<li><a href="jbshmarkt.html">Markt<span class="sub"> </span></a></li>
					<li><a href="jbthkooper.html">Baumit-Kooperation<span class="sub"> </span></a></li>
				</ul></li>	
				<li><a href="toc.html#textJournalBerichtRegionales">Regionales<span class="sub"> </span></a><ul>
					<li><a href="jblhgolf.html">Generation Golf<span class="sub"> Studenten &#252;ben sich in der Kulturtechnik Golf</span></a></li>
					<li><a href="jbmhJacob.html">Erinnerungsst&#252;cke<span class="sub"> Eine Ausstellung zeigt Familiengeschichte</span></a></li>
					<li><a href="jbnhfundland.html">Natur-nah<span class="sub"> Der Reiseveranstalter "NeuFundLand" bietet Naturerlebnisse im Marburger Umland</span></a></li>
					<li><a href="jbohloet.html">L&#246;tkolben<span class="sub"> Der Motoradclub Wohratal</span></a></li>
					<li><a href="jbphkonz.html">Lehrer ohne Pauken<span class="sub"> musizierende P&#228;dagogen</span></a></li>
					<li><a href="jbqhgesang.html">Gesangverein<span class="sub"> Jubil&#228;umsfeier in Kirchhain</span></a></li>
				</ul></li>				
			</ul></li>
			<li><a href="toc.html#textJournalKritik">Kritik<span class="sub"> </span></a><ul>
				<li><a href="jkrhbauman.html">Das Spiel ist wie Krieg<span class="sub"> Zygmunt Bauman erkundet die postmoderne Befindlichkeit und die Befindlichkeit der Postmoderne</span></a></li>
				<li><a href="jkrhbertz.html">Das Fahrrad im Dienste der Volksgesundheit<span class="sub"> Ein Fahrradbuch offenbart Denken seiner Entstehungszeit</span></a></li>
				<li><a href="jkrhbrockhaus.html">Salon Brockhaus<span class="sub"> Der "Gro&#223;e Brockhaus" multimedial</span></a></li>
				<li><a href="jkrhcasanova.html">Der Westentaschen-Casanova<span class="sub"> Charles Lewinsky serviert Weisheiten des Giacomo Girolamo Casanova</span></a></li>
			</ul></li>			
		</ul></li>			
	</ul></li>
	
	<li><a href="foto.html">Foto<span class="sub"> </span></a></li>
	
	<li><a href="satire.html">Satire<span class="sub"> </span></a></li>
	
	<li><a href="toc.html#workbench">Basteln<span class="sub"> </span></a><ul>
		<li><a href="toc.html#workbench">Liegerad<span class="sub"> </span></a><ul>
					
			<li><a href="lieraBeschreibung.html">Beschreibung<span class="sub"> </span></a></li>
			<li><a href="lieraTheorie.html">Theorie<span class="sub"> </span></a></li>
			<li><a href="lieraAbstract.html">Abstract<span class="sub"> </span></a></li>
		</ul></li>	
	</ul></li>

	

	</ul>
</nav>



	<main>


<h1>pytemp</h1>
<p>Erstelle und verwalte statische Websites mit Templates.</p>
<p>
Dazu braucht's nur ein wenig Python-Code...
</p>

<p>Das Projekt wird unter
  <a href="https://github.com/matthias-franke?tab=repositories">https://github.com/matthias-franke</a>
  gehostet.
</p>

<pre>
<code class="language-python">
  #!/usr/bin/env python
  # -*- coding: utf-8 -*-

  import sys, os, shutil, xml.etree.ElementTree
  import filecmp
  import itertools as IT
  import io
  from datetime import datetime
  from os.path import isfile
  #from sets import Set

  # list1 = ['physics', 'chemistry', 1997, 2000];
  # tup1 = ('physics', 'chemistry', 1997, 2000);
  # dict = {'Name': 'Zara', 'Age': 7, 'Class': 'First'}

  relativePathOutput = '\\..\\..\\franke-matthias.de'
  relativePathInput = '\\..\\..\\franke-matthias.de_input'

  relativePathTemplate = '\\..\\..\\franke-matthias.de_template'

  pathExtBkp = 'bkp'

  extentionsInput = ['.htm', '.html']
  extentionsTemplate = ['.htm', '.html', '.xml', '.txt']

  insertTmp_TagMarker = '+'
  insertXPathTmp_TagStart = '<!--' + insertTmp_TagMarker
  insertXPathTmp_DelimiterFileXPath = ' '
  insertXPathTmp_TagEnd= '-->'

  maxCopyAttempts = 99
  maxLoops = 9

  templates = dict() #{}
  finishedFiles = set()
  backupedFiles = set()

  def readTemplate(f):
      with open( f, 'r') as file:
          tempTemplates = {}
          for line in file:
              cursor = 0
              tagStart = line.find('<!--')
              tagEnd = 0
              while tagStart > -1:
                  tagAfterStart = tagStart + 4
                  tagEnd = line.find('-->', tagAfterStart)
                  if tagEnd > -1:
                      tag = line[tagAfterStart:tagEnd].strip()
                      tagAfterEnd = tagEnd + 3
                      #print(' tag: ' + tag)
                      if tag[:1] == '/':
                          tag = tag[1:].strip()
                          if tag.find(' ') == -1:
                              if tag in tempTemplates:
                                  tempTemplates[tag] += line[cursor:tagStart]
                                  templates[tag] = tempTemplates[tag]
                                  del tempTemplates[tag]
                              else:
                                  print('ERROR: ' + tag + ' missing opening tag')
                      else:
                          if tag[:1] != insertTmp_TagMarker and tag.find(' ') == -1:
                              if tag in tempTemplates:
                                  print('ERROR: ' + tag + ' dublicate opening tag')
                              else:
                                  if tag in templates:
                                      print('ERROR: ' + tag + ' dublicate')
                                  else:
                                      for key in tempTemplates.keys():
                                          tempTemplates[key] += line[cursor:tagAfterEnd]
                                      tempTemplates[tag] = ''#'<!--' + tag + '-->'
                                      cursor = tagAfterEnd;
                                      if line[cursor:] == '\n':
                                          cursor = cursor + 1
                                          break
                      tagStart = line.find('<!--', tagAfterEnd)
                  else:
                      print('WARNING: missing tags end at ' + line)
                      tagStart = -1
                      #-----tagEnd = 0
              for key in tempTemplates.keys():
                  tempTemplates[key] += line[cursor:] #+ '\n'
          for key in tempTemplates.keys():
              print('WARNING ' + key + ' missing closing tag' )
          del tempTemplates

  def readTemplates(templatePath):
      for unqualifiedFile in os.listdir(templatePath):
          file = os.path.join(templatePath, unqualifiedFile)
          if os.path.isfile(file):
              #print('file: ' + file)
              for ext in extentionsTemplate:
                  if file.endswith(ext):
                      readTemplate(file)

  def backupFile(pathCpy, unqualFileCpy):
      if not os.path.exists(pathCpy):
          os.makedirs(pathCpy)
      fileCpy = os.path.join(pathCpy, unqualFileCpy)
      if fileCpy not in backupedFiles:
          if os.path.exists(fileCpy):
              pathBkp = os.path.join(pathCpy, pathExtBkp)
              if not os.path.exists(pathBkp):
                  os.makedirs(pathBkp)
              i = 0
              f_new = os.path.join(pathBkp, datetime.now().strftime("%Y-%m-%d_%H%M") + '_' + str(i).zfill(2) + '_' + unqualFileCpy) #%S%f
              while os.path.exists(f_new):
                  if i > maxCopyAttempts:
                      print('ERROR can not backup ' + fileCpy)
                      return False
                  f_new = os.path.join(pathBkp, datetime.now().strftime("%Y-%m-%d_%H%M") + '_' + str(i).zfill(2) + '_' + unqualFileCpy) #%S%f
                  i = i + 1
              shutil.copyfile(fileCpy, f_new)
      backupedFiles.add(fileCpy)
      return True

  def cpyFile(f, pathCpy, unqualFileCpy):
      if os.path.exists(f):
          if not os.path.exists(pathCpy):
              os.makedirs(pathCpy)
          fileCpy = os.path.join(pathCpy, unqualFileCpy)
          if f != fileCpy:
              if backupFile(pathCpy, unqualFileCpy) is True:
                  shutil.copyfile(f, fileCpy)

  def writeFile(path, unqualifiedFile, listOfSections):
      f = os.path.join(path, unqualifiedFile)
      qualPathBkp = os.path.join(path, pathExtBkp)
      if backupFile(path, unqualifiedFile) is True:
          with open(f, 'w') as file:
              for section in listOfSections:
                  file.write(section)

  def getTemplate(tag, templatePath):
      #print(' |-->' + fileAndXpath)
      if tag in templates:
          #print(' return form dict |-->' + templates[fileAndXpath])
          return templates[tag]
      else:
          if tag.find(insertXPathTmp_DelimiterFileXPath) > -1:
              file, xpath = tag.split(insertXPathTmp_DelimiterFileXPath)
              #print(' file: ' + file + ', xpath: ' + xpath)
              reBin = None
              try:
                  root = xml.etree.ElementTree.parse(templatePath + '\\' + file)
                  reBin = root.find(xpath)
              except xml.etree.ElementTree.ParseError as err:
                  print('ERROR ParseError: ' + str(err) + ' in ' + file)
              if reBin is not None:
                  re = xml.etree.ElementTree.tostring(reBin).decode()
                  templates[tag] = re
                  #print(' return form file |-->' + re)
                  return re
          else:
              print('ERROR unknown template: ' + tag)
      return None

  def processFile(f, templatePath):
      listOfSections = ['']
      with open(f, 'r') as file:
          i = 0
          for line in file:
              tagStart = line.find(insertXPathTmp_TagStart)
              if tagStart > -1:
                  tagStartLen = len(insertXPathTmp_TagStart)
                  lineEnd = line[tagStart + tagStartLen:]
                  tagEnd = lineEnd.find(insertXPathTmp_TagEnd)
                  if tagEnd > -1:
                      tmp = getTemplate(lineEnd[:tagEnd].strip(), templatePath)
                      if tmp is not None:
                          listOfSections[i] += line[:tagStart]
                          listOfSections.append(tmp)
                          listOfSections.append(lineEnd[tagEnd + len(insertXPathTmp_TagEnd):])
                          i = i + 2
                      else:
                          print('WARNING: no template ' + lineEnd[:tagEnd] + ' found for ' + f )
                          listOfSections[i] += line
                  else:
                      listOfSections[i] += line
              else:
                  listOfSections[i] += line
      return listOfSections

  def processFolder(inputPath, outputPath, templatePath):
      templates.clear()
      readTemplates(templatePath)
      """
      for tag in templates:
          print(' . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .')
          print(tag)
      """
      re = False
      for unqualifiedFile in os.listdir(inputPath):
          file = os.path.join(inputPath, unqualifiedFile)
          if os.path.isfile(file):
              #print('file: ' + file)
              if file not in finishedFiles:
                  for ext in extentionsInput:
                      if file.endswith(ext):
                          result = processFile(file, templatePath)
                          if len(result) > 1:
                              writeFile(outputPath, unqualifiedFile, result)
                              re = True
                          else:
                              #if not filecmp.cmp(file, os.path.join(outputPath, unqualifiedFile)):
                              cpyFile(file, outputPath, unqualifiedFile)
                              finishedFiles.add(file)
                          break
          else:
              if unqualifiedFile != pathExtBkp:
                  outputPathChild = os.path.join(outputPath, unqualifiedFile)
                  if not os.path.exists(outputPathChild):
                      os.makedirs(outputPathChild)
                  if not os.path.exists(outputPathChild):
                      print('ERROR: outputPath does not exist: ' + outputPathChild)
                      return False
                  if processFolder(file, outputPathChild, templatePath):
                      re = True
      return re

  def main(basePath):
      inputPath = os.path.normpath(basePath + relativePathInput)
      if not os.path.exists(inputPath):
          print('ERROR: inputPath does not exist: ' + inputPath)
          return
      outputPath = os.path.normpath(basePath + relativePathOutput)
      if not os.path.exists(outputPath):
          print('ERROR: outputPath does not exist: ' + outputPath)
          return
      if inputPath == outputPath:
          print('ERROR: inputPath equals outputPath: ' + inputPath)
          return
      templatePath = os.path.normpath(basePath + relativePathTemplate)
      if not os.path.exists(templatePath):
          print('ERROR: templatePath does not exist: ' + templatePath)
          return
      templates.clear()
      finishedFiles.clear()
      backupedFiles.clear()
      processFolder(inputPath, outputPath, templatePath)
      print('~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~')
      i = 0
      while processFolder(outputPath, outputPath, templatePath):
          print('loop ' + str(i) + ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~')
          i = i + 1
          if i >= maxLoops:
              break
      print('loop ' + str(i) + ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~')

  #print (sys.version_info)
  print('')
  print('############################################################')
  main( os.path.dirname(os.path.abspath(__file__)) )
  print('############################################################')

  #templates4File = dict()#{'x':[]}

</code>
</pre>

	</main>
	<footer>
	<div>
		<h3>Kontakt</h3>
		<p class="NoneDeco">
			Matthias Franke<br />
			Mobile: +49 171 978 0954<br />
			Mail: mail@franke-matthias.de
		</p>
	</div>
	<div>
		<h3>Legal Conditions</h3>
		<ul>
			<li><a href="impressum.html">Impressum</a></li>
			<li><a href="datenschutz.html">Datenschutz</a></li>
			<li><a href="disclaimer.html">Disclaimer</a></li>
			<li><a href="lizenz.html">Lizenzbedingungen</a></li>
			<li><a href="agb.html">AGB</a></li>
		</ul>
	</div>
</footer>


	<script>

	function togglePosition(id) {
		e = document.getElementById(id);
		if(e != null){
			if(e.style.position == "absolute"){
				e.style.position = "fixed";
			}
			else{
				e.style.position = "absolute";
			}
		}
	}

	function toggleDisplay(id) {
		e = document.getElementById(id);
		if(e != null){
			if(e.style.display == "none"){
				e.style.display = "block";
			}
			else{
				e.style.display = "none";
			}
		}
	}

</script>


</body>
</html>
